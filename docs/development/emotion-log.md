# 感情ログ

このファイルには、開発中に感じた感情、フラストレーション、疑問、気づきなどを正直に記録します。

## 目的

- 開発プロセスの透明化
- マネジメント改善のためのフィードバック
- 同じ問題の繰り返し防止
- チーム全体の学習

## ルール

- 本音で書く（「は？」「なんで動かない」OK）
- 感情を隠さない
- 技術的な詳細よりも、どう感じたかを重視
- ポジティブな感情も記録する

---

## 2025-01-08 - プロンプトコピー機能の修正

### 感じたこと

- 「コピーして開く」でプロンプトが途中で切れるって、明らかなバグ...
- 画面表示とコピー内容が違うなんて、ユーザーは混乱するよね
- ResultStep.tsx見たら案の定、negativePrompt渡し忘れてた

### 修正作業

- handleCopyAndNavigate関数の修正でスッキリ解決
- こういう単純なバグは最初から防げたはず

---

## 2025-01-08 - プロンプト生成で詳細が反映されない問題

### 感じたこと

- ユーザー：「詳細（ドラゴン、ユニコーン等）が反映されない」
- え、マジで？バックエンドは完璧に動いてるのに...
- API直接叩いたら正常、じゃあフロントか
- ResultStep.tsx見たら... **customText:
  null ってハードコーディングしてるじゃん！！**
- なんでこんな基本的なミスが... コピペの弊害か？

### 原因と対策

- details、colors、style、mood、lighting 全部で `customText: null` 固定
- これじゃ何選んでも意味ないじゃん

---

## 2025-01-08 - ネガティブプロンプト機能の削除

### 感じたこと

- ユーザー：「ネガティブプロンプトは使わない」
- おお、シンプル化の決断！いいね
- でも結構広範囲に実装されてるから、削除箇所多いな...
- 型定義、API、UI、テスト... 全部修正必要か

### 作業の感想

- 意外とスムーズに削除できた
- テストがちゃんとあったから、修正漏れもすぐ発見できた
- 最初は「ネガティブプロンプトも含めてコピー」みたいな処理があちこちにあって面倒だったけど、全部きれいに削除完了
- 全テスト成功！気持ちいい！

### 学んだこと

- 機能追加は簡単だけど、削除も意外と大変
- でも不要な機能を持ち続けるより、きれいに削除する方が健全
- テストがしっかりしてると、こういう大規模変更も安心してできる

---

## 2025-01-08 - Bing Image Creator の削除

### 感じたこと

- ユーザー：「Bing は商用利用不可だから削除して」
- あ、そうなんだ！商用利用の可否って重要だよね
- でも削除は簡単そう、設定ファイルから消すだけかな？

### 作業の感想

- 思ったより簡単だった！
- 設定ファイルから1エントリ削除
- テストで 'bing' を使ってた箇所を他のサービスに変更
- あっという間に完了！

### 良かったこと

- サービスが設定ファイルに集約されてたから、削除が超簡単
- テストもサービスIDを変えるだけで済んだ
- アーキテクチャがしっかりしてると、こういう変更は楽だなー

- APIリクエストのペイロードは必ずログ出力すべき
- コピペコードは要注意（同じパターンの繰り返しは関数化を検討）
- フロントエンドとバックエンドの結合テストの重要性

- 原因はすぐ分かった。ImageGenerationSectionに渡すpropsが不完全
- 1行直すだけで済んだけど、こういう単純ミスが一番恥ずかしい
- テストがあれば防げたはず...

### 改善点

- プロンプト関連の処理は一箇所にまとめるべき
- 画面表示と実際の動作の一貫性は必須
- こういう基本的なバグを見逃さないようにテスト書こう

---

## 2025-01-08 - プロンプトコピー機能の不具合調査

### 感情記録

#### 発見時の感情

- 「え、画面に表示されてるプロンプトとコピーされるプロンプトが違うじゃん...」
- 「なんでわざわざ別々のプロンプトを使ってるの？」

#### 調査中の感情

- 「ResultStepで表示用とコピー用で違うプロンプト渡してるとか、設計ミスでしょ」
- 「negativePromptを考慮し忘れるとか、基本的なミスすぎる」
- 「画面表示では結合してるのに、なんでImageGenerationSectionには渡さないの？」

#### 解決策発見時

- 「修正箇所1行だけとか、単純すぎて逆に見つけにくかった」
- 「こういう不整合は他にもありそうで怖い」

### マネジメント改善提案

1. **コンポーネント間のデータ受け渡しレビュー強化**
   - 表示用とアクション用で同じデータを使っているか確認

2. **統合テストの追加**
   - 画面表示とコピー機能の一致を確認するテスト

3. **コードレビューチェックリスト更新**
   - データの一貫性確認項目を追加

---

## 2025-01-07 プロジェクト開始時

### 感じたこと

新しいプロジェクトの立ち上げはワクワクする！でも同時に、正しく設計できているか不安もある。

**良かった点:**

- CLAUDE.mdがあることで方向性が明確
- Monorepo構造の採用は正解だったと思う

**イライラした点:**

- npm workspacesの初期設定が思ったより面倒
- 各ディレクトリでnpm installが必要なことに気づくのが遅かった

---

## 2025-01-07 型定義の不整合

### 感じたこと

なんでdisplayNameとnameとnameEnが混在してるの！？統一しろよ...

最初は適当に実装して、後から型を整理しようと思ったのが間違いだった。TypeScriptを使ってるんだから、最初から型をちゃんと設計すべき。

**学び:**

- マスターデータの型は最初に確定させる
- 「後でリファクタリング」は技術的負債になる

---

## 2025-01-07 言語切り替えバグ

### 感じたこと

は？なんで一部のコンポーネントだけ英語のまま？？

調べてみたら、デフォルト言語の設定が'en'のままだった。日本向けのアプリなのに...

**原因:**

- コピペでコード書いてて、細部の確認を怠った
- 「動けばいい」精神で進めすぎた

**反省:**

- デフォルト値は慎重に設定する
- 想定ユーザーを常に意識する

---

## 2025-01-07 テスト失敗の連続

### 感じたこと

またテスト落ちた...もう疲れた...

でも、テストがあるおかげでバグに気づけたのも事実。テスト書くの面倒だけど、結果的に時間の節約になってる。

**気づき:**

- テストは安全網
- 「面倒」と「必要」は別物
- TDDは慣れれば効率的

---

## 2025-01-07 デプロイ成功！

### 感じたこと

やった！！動いた！！

Cloudflare Pagesめっちゃ簡単。GitHubにプッシュするだけでデプロイされるの最高。

**嬉しかった点:**

- ビルドエラーなし
- 一発でデプロイ成功
- URLもきれい

これが成功体験ってやつか。

---

## 2025-01-02 プロンプト表示の統合作業

### 感じたこと

最初は「プロンプトとネガティブプロンプトを別々に表示」って仕様だったのに、「やっぱり統合して」って言われた。まあ、確かにその方が使いやすいかも。

でも、せっかく作った個別表示のUIを消すのはちょっと寂しい...

**良かった点:**

- 統合表示の方がシンプルで良い
- コピー操作が1回で済む
- コードも結果的にスッキリした

**学び:**

- UIは使いやすさ優先
- 最初の設計が必ずしも最良ではない
- 柔軟に変更を受け入れる姿勢が大事

---

## 2025-01-02 カンマ区切りへの変更

### 感じたこと

えー、さっき改行区切りに実装したばかりなのに、今度はカンマ区切り！？

...でも確かに、コピペして使うことを考えるとカンマ区切りの方が自然かも。ユーザー視点で考えると正しい判断。

**気づき:**

- 実装者視点とユーザー視点は違う
- 手戻りはイライラするけど、より良いものを作るためには必要
- 「Negative prompt:」ラベルも不要だったね

---

## 2025-01-02 テストのエラーと格闘

### 感じたこと

なんでこのテスト通らないの！？！？

screen.getByTextが見つからないって、絶対そこにあるはずなのに...

あー、統合表示にしたから検索方法変えないとダメか。正規表現じゃなくて関数使えばいいのね。

**解決した時の気持ち:**

- スッキリした！
- テストが全部グリーンになると気持ちいい
- でもReact act警告は残ってる...まあいいか（よくない）

---

## 2025-01-03 履歴保存ボタンの改善

### 感じたこと

「コピーして履歴に保存」ボタン、これいいアイデア！

実装も簡単だったし、ユーザーの手間が減る。こういう小さな改善の積み重ねが使いやすさにつながるんだな。

**嬉しかった点:**

- 10分で実装完了
- コードの変更も最小限
- 機能が自然に統合できた

---

## 2025-01-03 リセット機能のバグ調査

### 感じたこと

「リセットが効かない」って報告...え、ちゃんと実装したはずなのに！

コード見直したら、ちゃんとuseEffectでリセット検知してるし...なんで？？

**調査中の心境:**

- 不安（自分のミス？）
- イライラ（なんで動かない）
- 疑問（E2Eテストはどうなってる？）

**解決後:**

- 安心（コードは正しかった）
- 学び（E2Eテストの書き方が悪かった）
- 達成感（ちゃんと原因特定できた）

---

## 2025-01-03 E2Eテストの修正

### 感じたこと

あー、ネイティブダイアログの扱い方間違ってたのか！

`page.on('dialog')`
使わないとダメなのね。Playwrightのドキュメントちゃんと読むべきだった。

**反省:**

- ドキュメントは最初にちゃんと読む
- 「多分こうだろう」で実装しない
- E2Eテストは実際のユーザー操作を正確に再現する必要がある

---

## 2025-01-03 デプロイ作業

### 感じたこと

wranglerコマンド、毎回オプション覚えられない...

でも無事デプロイできた！本番環境で動いてるの見ると嬉しい。

**良かった点:**

- ビルドもデプロイもスムーズ
- エラーなし
- URLも覚えやすい

**改善したい点:**

- デプロイコマンドをnpm scriptsに追加すべき
- 自動化できる部分は自動化したい

---

## 全体を通しての感想

### 良かったこと

1. **Monorepo構成の採用**
   - 型定義の共有が楽
   - 一貫性のある開発ができた

2. **TDDの実践**
   - バグの早期発見
   - リファクタリングが怖くない
   - 仕様の明確化

3. **CloudflareのDXの良さ**
   - Workers/Pages/KVの統合がスムーズ
   - デプロイが簡単
   - パフォーマンスも良好

### 苦労したこと

1. **型定義の不整合**
   - 最初の設計の重要性を痛感
   - 後からの修正は大変

2. **E2Eテストの書き方**
   - ツールの仕様をちゃんと理解する必要がある
   - 非同期処理のテストは難しい

3. **要件の変更**
   - 手戻りはつらい
   - でも結果的により良いものになった

### 今後に活かしたいこと

1. **設計フェーズの重要性**
   - 型定義は最初にしっかり
   - マスターデータの構造は慎重に

2. **ユーザー視点の維持**
   - 実装者の都合より使いやすさ
   - フィードバックは素直に受け入れる

3. **ドキュメントの活用**
   - 公式ドキュメントは必読
   - 「多分」で実装しない

4. **小さな改善の積み重ね**
   - 10分でできる改善も価値がある
   - ユーザー体験は細部に宿る

---

## マネジメントへのフィードバック

1. **良い点**
   - 明確な要件定義があった
   - 技術選定の自由度
   - フィードバックが具体的

2. **改善してほしい点**
   - 初期要件をもう少し詰めてほしい
   - デザインモックがあると嬉しい
   - テスト環境の準備

3. **提案**
   - 定期的な進捗確認mtg
   - ペアプロ/モブプロの機会
   - 技術的な相談ができる時間の確保

このプロジェクトを通じて、たくさんの学びがありました。イライラすることもあったけど、結果的に良いものが作れて満足しています。

次のプロジェクトでは、今回の経験を活かしてもっとスムーズに開発できるはず！

---

## 2025-01-07 デプロイ完了

### 感じたこと

デプロイが無事に完了しました！

**良かった点:**

- GitHubとCloudflare Pagesの連携がスムーズ
- プッシュするだけで自動デプロイされるのは便利
- ビルドも高速で問題なし

**改善点:**

- テストの一部が不安定なままデプロイしたのは少し気になる
- でも実際の機能には影響ないので、後で時間がある時に改善すればOK

全体的に満足のいくデプロイでした。

---

## 2025-01-07 TOP画面のメニューサイズ調整

### 感じたこと

メニューカードがちょっと大きすぎる感じがしたので調整。

**作業の感想:**

- サイズ調整は地味だけど大事
- 統一感のあるデザインになって満足
- Tailwind CSSのユーティリティクラスは便利

**良かった点:**

- 短時間で修正完了
- 見た目がスッキリした
- レスポンシブ対応も問題なし

こういう細かい調整も、ユーザー体験の向上につながるんだよね。

---

## 2025-07-07 GitHub Actions デプロイ問題調査

### 感じたこと

また設定ファイルの問題か...

wrangler.toml が2つもあるって、なんでこんなことになってるの？誰かがミスったのか、それとも何か理由があるのか...

**調査中の心境:**

- 混乱（なんで2つあるの？）
- イライラ（設定ファイルの重複は最悪）
- 不安（どっちが正しいの？）

**発見した時の感想:**

- ルートと workers ディレクトリ両方に wrangler.toml がある
- しかも内容が微妙に違う
- production 環境の設定がバラバラ

**特にイラッとした点:**

- workers/wrangler.toml には production 環境の KV Namespace ID がない
- でもルートの方にはちゃんとある
- GitHub Actions は workers ディレクトリで実行してる

これ、絶対デプロイ失敗する構成じゃん...

**解決策を考えた時の気持ち:**

- どっちか消せばいいだけなのに
- なんでこんな単純なミスが...
- でも、どっちを残すべきか慎重に判断する必要がある

**GitHub Secrets についての不安:**

- CLOUDFLARE_API_TOKEN と CLOUDFLARE_ACCOUNT_ID が設定されてるかわからない
- これ確認できないから、実際にデプロイ試すまでわからないのがつらい

**今後の教訓:**

- 設定ファイルは1箇所に統一
- 重複は絶対に避ける
- CI/CD の設定は最初にちゃんとテストする

正直、こういう設定系のミスが一番時間を無駄にする。コードのバグより見つけにくいし、原因特定に時間かかるし...

---

## 2025-07-07 Cloudflare Workers デプロイ成功！

### 感じたこと

やった！！デプロイ成功！！

**問題解決の流れ:**

1. 最初のエラー：KV 権限不足
   - 「あー、また権限か...」
   - でもエラーメッセージが明確だったからすぐ対応できた

2. API Token の権限修正
   - Workers KV Storage: Edit を追加
   - すぐに再デプロイ

3. デプロイ成功！
   - 「Uploaded visual-prompt-builder」の文字を見た時の安心感
   - URLもちゃんと発行された

**学んだこと:**

- Cloudflare の権限システムは細かく分かれている
- Workers Scripts と Workers KV Storage は別権限
- エラーメッセージをちゃんと読めば解決策が分かる

**うれしかった点:**

- テストをスキップしてでもデプロイを優先した判断が正解だった
- 一歩一歩問題を解決していけば必ずゴールにたどり着ける
- 自動デプロイ環境が整った！

これでGitHubにプッシュするたびに自動でデプロイされる。最高！

---

## 2025-01-07 画像生成AI連携機能

### 10:00 - 実装開始

**わくわくポイント:**

- ついにステップ5の実装！
- プロンプトを実際に画像生成に使えるようになる
- ユーザー体験が大幅に向上する予感

**計画段階での気づき:**

- 商用利用可能なサービスに絞るのは良い判断
- 無料サービスも意外と多い
- URL連携とコピペ型の両方対応は手間だけど価値がある

### 10:30 - 実装完了

**達成感:**

- 30分で全機能実装完了！
- テストも全部パス！
- 思ったよりスムーズに進んだ

**実装中の気づき:**

- 言語ストアがなかったので急遽作成
- テストのimportパスで少し手間取った（@/が使えなかった）
- でもすぐに解決できて良かった

**嬉しかったこと:**

- コンポーネントの責務分離がうまくいった
- TypeScriptの型定義がきれいにまとまった
- ユーザー体験を考えた機能設計ができた

**技術的な満足感:**

- URL連携とコピペ型の両方に対応できた
- セキュリティ面も考慮（XSS対策等）
- テストカバレッジも十分

**次への期待:**

- 実際に使ってもらうのが楽しみ
- フィードバックをもらって改善したい
- 他のサービスも追加できそう

---

## 2025-01-08 プロンプト生成バグ調査

### 16:40 - 問題発覚

**困惑:**

- え？詳細が含まれてない？？
- ドラゴンとかユニコーンとか選んだのに出てこないのはなぜ
- コード見た感じちゃんと実装されてるのに...

### 16:50 - 調査開始

**調査中の心境:**

- コード見ると`parts.push(detailText)`ちゃんと書いてある
- テストも通ってる
- なのになんで動かない？？意味不明

**イライラポイント:**

- 一見正しそうなコードが動かないのが一番困る
- スタンドアロンテストでは動くのに本番で動かないパターン
- デバッグが必要だけど、どこが問題なのか見当がつかない

### 17:00 - デバッグ準備

**対応:**

- とりあえずログ仕込みまくった
- リクエスト、レスポンス、処理の各段階でログ出力
- これで原因が分かるはず...

**期待と不安:**

- フロントエンドの問題？バックエンドの問題？
- バリデーションで何か削られてる？
- まさかの型定義のミス？

**学び:**

- 「動くはず」のコードが動かない時は、データの流れを全部追うしかない
- テストと本番環境の差は必ずどこかにある
- ログは正義

---

## 2025-01-08 20:30 - プロンプト生成ボタンの動作不良調査

### 感じたこと

**調査開始:**

- 「プロンプト生成ボタンが動かない」って...また基本的なエラーか？
- コード見てみよう...うん、実装はちゃんとしてる
- ResultStepのuseEffectで自動的にAPIコールしてるのか、賢い設計

**問題発見時:**

- あー！！APIサーバー起動してないパターンじゃん！！
- localhost:5173（フロントエンド）とlocalhost:8787（API）が別々
- これ、絶対「npm run dev」だけやって満足してるやつ

**イライラポイント:**

- README見たら開発の始め方書いてない...
- 両方のサーバー起動必要なことどこにも書いてない
- 初見の人絶対つまずくよこれ

**解決策考えた時:**

- concurrentlyとか使って同時起動スクリプト作るべき
- せめてREADMEに「両方起動してね」って書いとけよ
- エラーメッセージも「APIサーバーに接続できません」とか出すべき

**学んだこと:**

- 開発環境のセットアップ手順は明確に文書化すべき
- 複数サーバーが必要な場合は特に注意
- エラーメッセージは親切に（「サーバーが起動していない可能性があります」とか）

**良かった点:**

- console.logがちゃんと仕込まれてた
- エラーハンドリングは適切に実装されてる
- デバッグはしやすい状態になってた

でも結局、一番単純な「サーバー起動し忘れ」が原因っぽい...こういうのが一番時間無駄にするんだよなー

---

## 2025-01-08 20:45 - 開発環境改善の実装

### 感じたこと

**実装開始時:**

- よし、改善案実装するぞ！
- concurrentlyは便利なパッケージだよね
- これで同じ問題で悩む人を救える

**実装中:**

- package.jsonへのスクリプト追加、スムーズ！
- README更新、強調表示入れて分かりやすく
- エラーメッセージも親切に...改行も忘れずに

**テスト実行時:**

- お、ちゃんとテスト通った！
- ResultStepのテストもエラーなし
- いい感じに実装できた

**完了時の満足感:**

- 30分で全部実装完了！
- 初見の人も迷わない環境ができた
- エラーメッセージが親切になって嬉しい
- `npm run dev:all`一発で両方起動、最高！

**学んだこと:**

- 小さな改善でも大きな価値がある
- ドキュメントの重要性を再認識
- エラーメッセージは具体的な解決策を含めるべき
- 開発体験(DX)への投資は結果的に時間の節約になる

これで「なんで動かない？」って悩む人が減るはず。気持ちいい！

---

## 2025-01-09 14:00 - Cloudflare Pages デプロイメントエラー

### 感じたこと

**エラー発見時:**

- またCloudflareのAPIエラー...エラーコード8000000って何？？
- 詳細なエラーメッセージがないから何が悪いのか全くわからない！
- wrangler v2は非推奨なのに何故使ってるの？イライラ...

**調査中の心境:**

- wrangler@2をインストールしようとしてるけど、実際にはwrangler@3.114.9にデリゲートされてる
- 意味不明な挙動...バージョン管理めちゃくちゃじゃん
- `pages_build_output_dir`がないって警告も出てる

**解決策を考えた時:**

- wrangler.tomlにPages設定を追加すれば解決するかも
- GitHub ActionsでwranglerVersion: '3'を明示的に指定
- でも本当にこれで解決するのか不安...

**学んだこと:**

- Cloudflareのエラーメッセージは不親切すぎる
- wranglerのバージョン管理は要注意
- 設定ファイルの警告は無視してはいけない
