# ユースケース仕様書

## 1. アクター定義

### 1.1 主要アクター

| アクター | 説明 | 特性 |
|----------|------|------|
| **利用者** | 就労継続支援B型事業所に通う障害を持つ方 | ・ITリテラシー：初心者〜中級<br>・年齢：20代〜60代<br>・障害種別：知的、精神、発達 |
| **支援員** | 利用者をサポートする事業所スタッフ | ・福祉専門職<br>・基本的なPC操作可能<br>・指導経験あり |
| **管理者** | 事業所の運営管理を行う責任者 | ・事業運営経験<br>・収益管理能力<br>・意思決定権限 |

### 1.2 システムアクター

| アクター | 説明 | インターフェース |
|----------|------|-------------|
| **翻訳API** | 日本語を英語に翻訳する外部サービス | REST API |
| **画像生成AI** | プロンプトから画像を生成する外部サービス | Webインターフェース |
| **ブラウザ** | システムを実行する環境 | HTML5対応 |

## 2. 利用者のユースケース

### UC-001: 基本的なプロンプト作成
**アクター**: 利用者
**優先度**: 高
**頻度**: 高（1日に複数回）

**前提条件**:
- システムにアクセス可能
- 基本的な操作説明を受けている
- ブラウザがJavaScriptを有効化している

**基本フロー**:
| ステップ | アクター | システム |
|--------|----------|----------|
| 1 | システムにアクセス | トップページを表示 |
| 2 | カテゴリ「動物」を選択 | 選択をハイライト、詳細オプションを更新 |
| 3 | 詳細「猫」を選択 | 選択を記録 |
| 4 | 色「パステルカラー」を選択 | 選択を記録 |
| 5 | スタイル「水彩画」を選択 | 選択を記録 |
| 6 | 雰囲気「穏やか」を選択 | 選択を記録 |
| 7 | 照明「やわらかい」を選択 | 選択を記録 |
| 8 | サイズ「1:1」を選択 | 選択を記録 |
| 9 | 「プロンプトを生成」クリック | プロンプトを生成・翻訳 |
| 10 | 生成結果を確認 | プロンプトを表示 |
| 11 | 「コピー」ボタンをクリック | クリップボードにコピー |

**代替フロー**:
- 3a. 自由記述欄に「三毛猫」と入力 → 入力内容を保存
- 9a. 翻訳APIエラー → エラーメッセージ表示、日本語プロンプトを出力

**事後条件**:
- 英語のプロンプトが生成される
- プロンプトがコピー可能な状態になる
- 履歴に保存される

**生成プロンプト例**:
```
a cute cat, pastel colors, watercolor style, calm atmosphere, soft lighting, square format, high quality, detailed, beautiful composition, professional, 8K resolution, sharp focus, masterpiece, best quality, ultra detailed, photorealistic, cinematic lighting, vibrant colors
```

### UC-002: 過去のプロンプトを再利用
**アクター**: 利用者

**前提条件**:
- 過去にプロンプトを生成している

**基本フロー**:
1. 利用者が「履歴」ボタンをクリックする
2. 過去に生成したプロンプト一覧が表示される
3. 再利用したいプロンプトを選択する
4. 選択内容が自動的に各フィールドに反映される
5. 必要に応じて内容を修正する
6. 「プロンプトを生成」ボタンをクリックする

**事後条件**:
- 過去のプロンプトを基にした新しいプロンプトが生成される

### UC-003: お気に入りプロンプトの利用
**アクター**: 利用者

**前提条件**:
- お気に入り登録されたプロンプトが存在する

**基本フロー**:
1. 利用者が「お気に入り」ボタンをクリックする
2. お気に入りプロンプト一覧が表示される
3. 使用したいプロンプトを選択する
4. プロンプトがそのまま生成される

**事後条件**:
- お気に入りのプロンプトが再生成される

## 3. 支援員のユースケース

### UC-004: 利用者のプロンプト作成支援
**アクター**: 支援員、利用者
**優先度**: 高
**頻度**: 高（毎日複数回）

**前提条件**:
- 支援員がシステムの操作に習熟している
- 支援マニュアルを参照可能

**基本フロー**:

| ステップ | 支援員のアクション | 利用者のアクション | 留意点 |
|--------|-----------------|--------------|----------|
| 1 | 利用者の隣に着席 | 支援を受ける準備 | パーソナルスペースに配慮 |
| 2 | 「今日はどんな画像を作りましょうか？」と問いかけ | 希望を伝える | オープンクエスチョン |
| 3 | カテゴリ一覧を指さして説明 | カテゴリを選択 | 視覚的にサポート |
| 4 | 各選択肢の意味を分かりやすく説明 | 理解して選択 | 専門用語を避ける |
| 5 | 迷った際はサンプル画像を提示 | サンプルを参考に選択 | 複数の選択肢を提示 |
| 6 | 自由記述の入力を支援/代行 | 思いを伝える | 利用者の言葉を尊重 |
| 7 | 生成ボタンのクリックを支援 | ボタンを押す | 必要に応じて手伝う |
| 8 | 生成結果を一緒に確認 | 結果を確認 | ポジティブなフィードバック |
| 9 | 「素晴らしいプロンプトができましたね」と称賛 | 達成感を得る | モチベーション向上 |

**支援のポイント**:
- 利用者のペースに合わせる
- 選択を強制しない
- 失敗を恐れない環境作り
- 創造性を尊重する

**事後条件**:
- 利用者の意図を反映したプロンプトが生成される
- 利用者が成功体験を得る
- 作業意欲が向上する

### UC-005: 複数利用者の管理
**アクター**: 支援員

**前提条件**:
- 複数の利用者を担当している

**基本フロー**:
1. 支援員が利用者Aのプロンプト作成を支援する
2. 作成したプロンプトを保存またはメモする
3. 利用者Bの支援に移る
4. 必要に応じて履歴から各利用者の作品を確認する

**事後条件**:
- 複数の利用者のプロンプトが適切に管理される

## 4. 管理者のユースケース

### UC-006: システム利用状況の確認
**アクター**: 管理者

**前提条件**:
- 管理者権限を持っている

**基本フロー**:
1. 管理者がシステムの利用統計を確認する
2. どのカテゴリがよく使われているか確認する
3. 利用者の活動頻度を把握する
4. 必要に応じて支援方針を調整する

**事後条件**:
- システムの利用状況が把握される

### UC-007: 事業報告用データの収集
**アクター**: 管理者

**前提条件**:
- ジグソーパズル販売事業の実績報告が必要

**基本フロー**:
1. 管理者が一定期間の利用実績を確認する
2. 作成されたプロンプト数を集計する
3. 人気のあるカテゴリやスタイルを分析する
4. 事業報告書にデータを記載する

**事後条件**:
- 事業報告に必要なデータが収集される

## 5. システム連携のユースケース

### UC-008: 画像生成AIとの連携
**アクター**: 利用者、画像生成AI

**前提条件**:
- プロンプトが生成されている
- 画像生成AIサービスが利用可能

**基本フロー**:
1. 利用者が生成されたプロンプトをコピーする
2. 画像生成AIサービスにアクセスする
3. プロンプトを貼り付ける
4. 画像生成を実行する
5. 生成された画像を確認する

**事後条件**:
- プロンプトに基づいた画像が生成される

## 6. エラーケース

### UC-009: 翻訳エラーの対処
**アクター**: 利用者、支援員
**優先度**: 中
**頻度**: 低（月に数回）

**前提条件**:
- インターネット接続が不安定
- 翻訳APIのサービス障害

**エラーシナリオ**:

| エラータイプ | 原因 | 対処方法 | ユーザーへの表示 |
|------------|------|----------|---------------|
| ネットワークエラー | 接続不可 | キャッシュ使用 | 「インターネット接続を確認してください」 |
| API制限 | 利用上限 | 別API使用 | 「しばらくお待ちください」 |
| タイムアウト | 応答遅延 | 自動リトライ | 「処理中です...」 |
| サーバーエラー | サービス障害 | 日本語出力 | 「翻訳サービスが利用できません」 |

**基本フロー**:
1. 利用者がプロンプト生成を実行
2. システムが翻訳APIを呼び出し
3. APIがエラーを返す
4. システムが自動リトライ（3回まで）
5. リトライ失敗時、エラーメッセージ表示
6. 「再試行」「日本語で出力」ボタン表示
7. 利用者が選択

**エラー時のフォールバック**:
```
【日本語プロンプト】
猫、パステルカラー、水彩画、穏やか、やわらかい照明、正方形

※翻訳サービスが一時的に利用できません。
上記の日本語をコピーして、画像生成AIに貼り付けてください。
```

**事後条件**:
- エラーが解決されるか、代替手段が提供される
- 利用者の作業が継続できる
- ストレスを最小限に抑える

### UC-010: 選択肢が表示されない場合
**アクター**: 利用者、支援員
**優先度**: 低
**頻度**: 稀（月に1回程度）

**前提条件**:
- JavaScriptの読み込みエラー
- ブラウザの互換性問題
- ネットワークの一時的不具合

**障害パターンと対処**:

| 障害内容 | 発生箇所 | 対処方法 | 支援員の対応 |
|----------|----------|----------|-------------|
| 選択肢非表示 | 詳細選択 | 画面更新 | 更新ボタンを案内 |
| レイアウト崩れ | 全画面 | ブラウザ再起動 | 別ブラウザを試す |
| ボタン無反応 | 生成ボタン | ページ再読込 | キャッシュクリア |
| 読込み停止 | 初期読込 | 5秒待機後更新 | URL直接入力 |

**基本フロー**:
1. 利用者がカテゴリを選択
2. 詳細選択肢が表示されない
3. 3秒待機後、エラーメッセージ表示
4. 「画面を更新」ボタン表示
5. 利用者がボタンをクリック
6. ページが再読み込みされる

**緊急対応モード**:
- 全ての選択を自由記述で入力可能
- テキストベースの簡易モードへ切り替え
- オフラインテンプレートの使用

**事後条件**:
- 何らかの方法でプロンプト作成が継続できる
- 障害報告が記録される
- 技術サポートへの連絡手順が明確

## 3. 非機能ユースケース（追加）

### UC-011: システムの学習
**アクター**: 新規利用者
**優先度**: 高
**目標**: 10分以内に基本操作を習得

**学習ステップ**:
1. トップページのチュートリアルを閲覧（2分）
2. サンプル作成を体験（5分）
3. 自分でプロンプト作成（3分）

### UC-012: アクセシビリティ確認
**アクター**: 視覚障害者
**優先度**: 高
**基準**: WCAG 2.1 レベルAA

**確認項目**:
- スクリーンリーダーで全操作可能
- キーボードのみでナビゲーション
- 高コントラストモードで表示
- 音声ガイド機能